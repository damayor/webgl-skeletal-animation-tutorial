<!DOCTYPE html>
<!-- saved from url=(0055)http://chinedufn.com/webgl-skeletal-animation-tutorial/ -->
<html><script async="" src="./WebGL Skeletal Animation Tutorial_files/analytics.js"></script><script>(function main() {
    // Create enabled event
    function fireEnabledEvent() {
        // If gli exists, then we are already present and shouldn't do anything
        if (!window.gli) {
            setTimeout(function () {
                var enabledEvent = document.createEvent("Event");
                enabledEvent.initEvent("WebGLEnabledEvent", true, true);
                document.dispatchEvent(enabledEvent);
            }, 0);
        } else {
            //console.log("WebGL Inspector already embedded on the page - disabling extension");
        }
    };

    // Grab the path root from the extension
    document.addEventListener("WebGLInspectorReadyEvent", function (e) {
        var pathElement = document.getElementById("__webglpathroot");
        if (window["gliloader"]) {
            gliloader.pathRoot = pathElement.innerText;
        } else {
            // TODO: more?
            window.gliCssUrl = pathElement.innerText + "gli.all.css";
        }
    }, false);

    // Rewrite getContext to snoop for webgl
    var originalGetContext = HTMLCanvasElement.prototype.getContext;
    if (!HTMLCanvasElement.prototype.getContextRaw) {
        HTMLCanvasElement.prototype.getContextRaw = originalGetContext;
    }
    HTMLCanvasElement.prototype.getContext = function () {
        var ignoreCanvas = this.internalInspectorSurface;
        if (ignoreCanvas) {
            return originalGetContext.apply(this, arguments);
        }

        var result = originalGetContext.apply(this, arguments);
        if (result == null) {
            return null;
        }

        var contextNames = ["moz-webgl", "webkit-3d", "experimental-webgl", "webgl", "3d"];
        var requestingWebGL = contextNames.indexOf(arguments[0]) != -1;
        if (requestingWebGL) {
            // Page is requesting a WebGL context!
            fireEnabledEvent(this);

            // If we are injected, inspect this context
            if (window.gli) {
                if (gli.host.inspectContext) {
                    // TODO: pull options from extension
                    result = gli.host.inspectContext(this, result);
                    // NOTE: execute in a timeout so that if the dom is not yet
                    // loaded this won't error out.
                    window.setTimeout(function() {
                        var hostUI = new gli.host.HostUI(result);
                        result.hostUI = hostUI; // just so we can access it later for debugging
                    }, 0);
                }
            }
        }

        return result;
    };
})();</script><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>WebGL Skeletal Animation Tutorial</title>
  <meta name="description" content="">

  <link rel="stylesheet" href="./WebGL Skeletal Animation Tutorial_files/main.css">
  <link rel="canonical" href="http://www.chinedufn.com/webgl-skeletal-animation-tutorial/">
  <link rel="alternate" type="application/rss+xml" title="CFN" href="http://www.chinedufn.com/feed.xml">
</head>


  <body>

    <header class="site-header">

  <div class="fixed-header">

    <a class="site-title" href="http://chinedufn.com/">CFN</a>

    <div class="always-visible-nav-links">
      <!-- <a class='nav-link' href='/courses'>Courses</a> -->
      <a class="nav-link" href="http://chinedufn.com/about">About</a>
    </div>
  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <!--

        <div class='check-out-course'>
          <div style='display: flex; align-items: center; justify-content: flex-start;'>
            <span id='check-out-text'>Get your hand held through WebGL basics</span>
            <span id='check-out-text'>Let's solve problems together</span>
          </div>
          <div>
            <em>Learn the ins and outs of basic WebGL through my beginners course!</em>
            <em>I'm currently available for two billable days per week of consulting. Get in touch!</em>
          </div>
          <div style='display: flex;'>
            <a
              href='/courses/webgl-basics-for-complete-beginners'
              onclick="ga('send', 'event', 'Course', 'visit', 'WebGL Beginner');"
            >
              Teach me WebGL !
            </a>
            <a href="mailto:frankie.nwafili@gmail.com">Let's Chat</a>
          </div>
        </div>
      -->

        <article class="post" itemscope="" itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">WebGL Skeletal Animation Tutorial</h1>
    <p class="post-meta"><time datetime="2017-05-24T16:54:00-04:00" itemprop="datePublished">May 24, 2017</time></p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <div id="skeletal-animation-tutorial"><canvas width="400" height="400"></canvas><input type="range" min="0" max="2" step="0.01" style="display: block;"><span>Playback Speed: 86%</span></div>

<p>In this tutorial you’ll learn how to render the above skeletal animation in your web browser using WebGL and a combination of small modules.</p>

<p>We’ll first install our dependencies, and then go step by step through our code implementation.</p>

<p>We won’t be diving into the math or shaders behind our skeletal animation, but we will be lightly introducing the larger systems that power it.</p>

<p>The goal of this tutorial is for you to walk away with a working skeletal animation, and a sense of how the pieces fit together.</p>

<p>So.. let’s dive right in.</p>

<h2 id="our-dependencies">Our dependencies</h2>

<p>First we’ll create the directory for our tutorial project.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>mkdir skeletal-animation-tutorial
<span class="nb">cd </span>skeletal-animation-tutorial
</code></pre>
</div>

<p>We’ll download the 3d model and texture that we’ll be using for our animation. These were created by following Sebastian Lague’s excellent <a href="https://www.youtube.com/watch?v=DiIoWrOlIRw">Blender character creation tutorial</a>.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>curl -OL https://github.com/chinedufn/skeletal-animation-system<span class="se">\</span>
/raw/8e5e9c247a5204b6fe20bc92d737f017fc64dc27/demo/webgl/asset<span class="se">\</span>
/cowboy.dae &gt; cowboy.dae
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>curl -OL https://github.com/chinedufn/skeletal-animation-system<span class="se">\</span>
/raw/8e5e9c247a5204b6fe20bc92d737f017fc64dc27/demo/webgl/asset/<span class="se">\</span>
cowboy-texture.png &gt; cowboy-texture.png
</code></pre>
</div>

<p>Let’s convert our COLLADA <code class="highlighter-rouge">.dae</code> 3d model file into a JSON file that we’ll be loading into our tutorial app.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>npm install -g collada-dae-parser@0.11.2 <span class="o">&amp;&amp;</span> <span class="se">\</span>
dae2json cowboy.dae &gt; cowboy.json
</code></pre>
</div>

<p>Now we’ll install the JavaScript modules that we need. We’ll install
specific versions of these modules so that we’re sure that this tutorial will work even if these modules receive breaking updates in the future.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>npm install keyframes-to-dual-quats@1.0.0 <span class="se">\</span>
load-collada-dae@0.6.0 <span class="se">\</span>
raf-loop@1.1.3 <span class="se">\</span>
skeletal-animation-system@0.6.2
</code></pre>
</div>

<p>And lastly we’ll install <code class="highlighter-rouge">budo</code>, a rapid prototyping tool that will make it easy for us to view our animation locally.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>npm install -g budo
</code></pre>
</div>

<p>Great - we’ve installed all of our dependencies you we will not need an internet connection for the remainder of the tutorial.</p>

<h2 id="implementing-our-animation">Implementing our animation</h2>

<p>Alright now that we’re all set up we can jump into writing some code.</p>

<p>You’ll learn more if you follow along and type out the code yourself,  but here’s the <a href="http://github.com/chinedufn/webgl-skeletal-animation-tutorial">tutorial’s source on GitHub</a> in case you get stuck.</p>

<hr>

<p>Let’s create our tutorial’s JavaScript file.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>touch tutorial.js
</code></pre>
</div>

<p>Now open up your empty <code class="highlighter-rouge">tutorial.js</code> file that you just created and in your favorite editor!</p>

<h3 id="creating-a-canvas">Creating a canvas</h3>

<p>Create the canvas that we’ll be rendering our animation onto.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">canvas</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">'canvas'</span><span class="p">)</span>
<span class="nx">canvas</span><span class="p">.</span><span class="nx">width</span> <span class="o">=</span> <span class="mi">400</span>
<span class="nx">canvas</span><span class="p">.</span><span class="nx">height</span> <span class="o">=</span> <span class="mi">400</span>

<span class="kd">var</span> <span class="nx">gl</span> <span class="o">=</span> <span class="nx">canvas</span><span class="p">.</span><span class="nx">getContext</span><span class="p">(</span><span class="s1">'webgl'</span><span class="p">)</span>
<span class="nx">gl</span><span class="p">.</span><span class="nx">enable</span><span class="p">(</span><span class="nx">gl</span><span class="p">.</span><span class="nx">DEPTH_TEST</span><span class="p">)</span>
</code></pre>
</div>

<h3 id="adding-controls">Adding controls</h3>

<p>Next we’ll create the slider that will control our animation’s playback speed. Dragging this slider will make our model walk in slow or fast motion.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">playbackSlider</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">'input'</span><span class="p">)</span>
<span class="nx">playbackSlider</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s1">'range'</span>
<span class="nx">playbackSlider</span><span class="p">.</span><span class="nx">min</span> <span class="o">=</span> <span class="mi">0</span>
<span class="nx">playbackSlider</span><span class="p">.</span><span class="nx">max</span> <span class="o">=</span> <span class="mi">2</span>
<span class="nx">playbackSlider</span><span class="p">.</span><span class="nx">step</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="nx">playbackSlider</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="mi">1</span>
<span class="nx">playbackSlider</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span> <span class="o">=</span> <span class="s1">'block'</span>
</code></pre>
</div>

<p>We’ll also create a span to display our playback speed.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">speedDisplay</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">'span'</span><span class="p">)</span>
<span class="nx">speedDisplay</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s1">'Playback Speed: 100%'</span>
</code></pre>
</div>

<p>Let’s now track our playback speed in a variable that we update whenever we drag our slider.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">playbackSpeed</span> <span class="o">=</span> <span class="mi">1</span>
<span class="nx">playbackSlider</span><span class="p">.</span><span class="nx">oninput</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="nx">playbackSpeed</span> <span class="o">=</span> <span class="nx">playbackSlider</span><span class="p">.</span><span class="nx">value</span>
  <span class="nx">speedDisplay</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s1">'Playback Speed: '</span> <span class="o">+</span> 
  <span class="p">(</span><span class="nx">playbackSpeed</span> <span class="o">*</span> <span class="mi">100</span><span class="p">).</span><span class="nx">toFixed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'%'</span>
<span class="p">}</span>
</code></pre>
</div>

<p>So far we’ve created the DOM elements that will power our (slightly) interactive animation. Now we’ll insert them into the page.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">demoLocation</span> <span class="o">=</span> 
<span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'#skeletal-animation-tutorial'</span><span class="p">)</span> 
<span class="o">||</span> <span class="nb">document</span><span class="p">.</span><span class="nx">body</span>
<span class="nx">demoLocation</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">canvas</span><span class="p">)</span>
<span class="nx">demoLocation</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">playbackSlider</span><span class="p">)</span>
<span class="nx">demoLocation</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">speedDisplay</span><span class="p">)</span>
</code></pre>
</div>

<h2 id="setting-up-our-3d-model">Setting up our 3d model</h2>

<p>Earlier in the tutorial we converted our COLLADA file into a JSON file. We’ll pull this file in and prepare it for usage.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">cowboyJSON</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'./cowboy.json'</span><span class="p">)</span>
<span class="kd">var</span> <span class="nx">keyframesToDualQuats</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'keyframes-to-dual-quats'</span><span class="p">)</span>
<span class="nx">cowboyJSON</span><span class="p">.</span><span class="nx">keyframes</span> <span class="o">=</span> <span class="nx">keyframesToDualQuats</span><span class="p">(</span><span class="nx">cowboyJSON</span><span class="p">.</span><span class="nx">keyframes</span><span class="p">)</span>
</code></pre>
</div>

<p><code class="highlighter-rouge">cowboyJSON.keyframes</code> had a bunch of 4x4 matrices that represent all of our 3d model’s bones at any given keyframe. We convert these matrices into dual quaternions.</p>

<p>The mathematical reasons for this are outside of the scope of this tutorial, but suffice it to say using dual quaternions helps with preventing our 3d model from getting oddly stretched and deformed when we’re interpolating between different keyframes.</p>

<hr>

<p>Next we’ll load up our model’s texture and then once that texture loads we’ll buffer our model’s data onto the GPU.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">cowboyModel</span>
<span class="kd">var</span> <span class="nx">texture</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">window</span><span class="p">.</span><span class="nx">Image</span><span class="p">()</span>

<span class="nx">texture</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="c1">// We buffer our 3d model data on the GPU </span>
  <span class="c1">// so that we can later draw it</span>
  <span class="kd">var</span> <span class="nx">loadCollada</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'load-collada-dae'</span><span class="p">)</span>
  <span class="nx">cowboyModel</span> <span class="o">=</span> <span class="nx">loadCollada</span><span class="p">(</span><span class="nx">gl</span><span class="p">,</span> <span class="nx">cowboyJSON</span><span class="p">,</span> <span class="p">{</span><span class="na">texture</span><span class="p">:</span> <span class="nx">texture</span><span class="p">})</span>

  <span class="nx">gl</span><span class="p">.</span><span class="nx">useProgram</span><span class="p">(</span><span class="nx">cowboyModel</span><span class="p">.</span><span class="nx">shaderProgram</span><span class="p">)</span>
<span class="p">}</span>
<span class="nx">texture</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="s1">'/cowboy-texture.png'</span>
</code></pre>
</div>

<hr>

<p>We now have everything that we need to render our 3d model, so we’ll start up a render loop.</p>

<p>In our loop we’ll first calculate where we want all of our model’s joints to be based on the current time.</p>

<p>We’ll then draw our model with it’s joints in these newly calculated locations.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">secondsElapsed</span> <span class="o">=</span> <span class="mi">0</span>

<span class="kd">var</span> <span class="nx">renderLoop</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'raf-loop'</span><span class="p">)</span>
<span class="kd">var</span> <span class="nx">animationSystem</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'skeletal-animation-system'</span><span class="p">)</span>

<span class="nx">renderLoop</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">millisecondsSinceLastRender</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">cowboyModel</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Add the rest of the tutorial code here</span>
  <span class="p">}</span>
<span class="p">}).</span><span class="nx">start</span><span class="p">()</span>
</code></pre>
</div>

<h3 id="implementing-our-render-loop">Implementing our render loop</h3>

<p><em>The rest of our tutorial’s code will go inside of the render loop that we just set up</em>.</p>

<p>We’ll first set up the uniform data that we’ll later pass into our model’s shader.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">uniforms</span> <span class="o">=</span> <span class="p">{</span>
  <span class="c1">// per-vertex lighting</span>
  <span class="na">uUseLighting</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
  <span class="na">uAmbientColor</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">],</span>
  <span class="c1">// NOTE: This lighting direction needs to be a normalized vector</span>
  <span class="na">uLightingDirection</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
  <span class="na">uDirectionalColor</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
  <span class="c1">// Move the model back 27 units so we can see it</span>
  <span class="na">uMVMatrix</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">27.0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
  <span class="na">uPMatrix</span><span class="p">:</span> 
  <span class="nx">require</span><span class="p">(</span><span class="s1">'gl-mat4/perspective'</span><span class="p">)([],</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span> <span class="o">/</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">400</span> <span class="o">/</span> <span class="mi">400</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="p">}</span>
</code></pre>
</div>

<hr>

<p>Now we’ll use <a href="https://github.com/chinedufn/skeletal-animation-system">skeletal-animation-system</a> to calculate all of our model’s joint’s dual quaternions for our current time.</p>

<p>Notice that we use our <code class="highlighter-rouge">playbackSpeed</code> to modify how quickly we increment our <code class="highlighter-rouge">secondsElapsed</code> which allows us to slow down or speed up  our animation’s playback speed using our <code class="highlighter-rouge">playbackSlider</code>.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">secondsElapsed</span> <span class="o">+=</span> <span class="nx">millisecondsSinceLastRender</span> <span class="o">*</span> <span class="nx">playbackSpeed</span> <span class="o">/</span> <span class="mi">1000</span>
<span class="kd">var</span> <span class="nx">interpolatedJoints</span> <span class="o">=</span> <span class="nx">animationSystem</span><span class="p">.</span><span class="nx">interpolateJoints</span><span class="p">({</span>
  <span class="na">currentTime</span><span class="p">:</span> <span class="nx">secondsElapsed</span><span class="p">,</span>
  <span class="na">keyframes</span><span class="p">:</span> <span class="nx">cowboyJSON</span><span class="p">.</span><span class="nx">keyframes</span><span class="p">,</span>
  <span class="na">jointNums</span><span class="p">:</span> 
  <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">17</span><span class="p">],</span>
  <span class="na">currentAnimation</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">range</span><span class="p">:</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">17</span><span class="p">],</span>
    <span class="na">startTime</span><span class="p">:</span> <span class="mi">0</span>
  <span class="p">}</span>
<span class="p">}).</span><span class="nx">joints</span>
</code></pre>
</div>

<p>Now that we have our interpolated joints we’ll add them to our skeletal animation shader’s uniforms.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">18</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
 <span class="nx">uniforms</span><span class="p">[</span><span class="s1">'boneRotQuaternions'</span> <span class="o">+</span> <span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">interpolatedJoints</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
 <span class="nx">uniforms</span><span class="p">[</span><span class="s1">'boneTransQuaternions'</span> <span class="o">+</span> <span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">interpolatedJoints</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">slice</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="p">}</span>
</code></pre>
</div>

<p>And last but not least, we call our <code class="highlighter-rouge">draw</code> function. This passes all of our uniform data above to the GPU and then uses it to draw our animated model.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">cowboyModel</span><span class="p">.</span><span class="nx">draw</span><span class="p">({</span>
  <span class="na">attributes</span><span class="p">:</span> <span class="nx">cowboyModel</span><span class="p">.</span><span class="nx">attributes</span><span class="p">,</span>
  <span class="na">uniforms</span><span class="p">:</span> <span class="nx">uniforms</span>
<span class="p">})</span>
</code></pre>
</div>

<p>And there you have it. With any luck you now have the code to render a skeletal animation in your browser.</p>

<p>Run <code class="highlighter-rouge">budo --open --live --host=127.0.0.1 tutorial.js</code> to view your work!</p>

<h2 id="good-job">Good job!</h2>

<p>What would you like to learn next? Let me know on Twitter!</p>

<p>Til’ next time,</p>

<p>- CFN</p>

<script src="./WebGL Skeletal Animation Tutorial_files/basic-overview-tutorial.js"></script>


  </div>

  <div style="margin-bottom: 2em;">
    Was this post interesting? You should
    <a id="twitter-share-btn" href="https://twitter.com/intent/tweet?text=WebGL%20Skeletal%20Animation%20Tutorial&amp;url=http://www.chinedufn.com/webgl-skeletal-animation-tutorial/&amp;via=chinedufn&amp;related=chinedufn" rel="nofollow" target="_blank" title="Share on Twitter" data-size="large">
  <span class="icon icon--twitter"><svg class="twitter-svg-icon" viewBox="0 0 16 16"><path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"></path></svg>
</span><span class="username">Tweet</span>
</a>


    it!
  </div>

  <div class="related-posts">
    You might also like:
    <ul>
      
      <li><a href="http://chinedufn.com/distribute-blender-addons-scripts-npm/">Distributing Blender Scripts and Addons via npm</a></li>
      
      <li><a href="http://chinedufn.com/blender-skinned-webgl-hot-reload/">Blender to WebGL Hot Reloading Experiment - Part 2/2</a></li>
      
      <li><a href="http://chinedufn.com/unit-testing-blender-addons-scripts/">Unit Testing Blender Scripts and Addons with Node.js</a></li>
      
    </ul>
  </div>

  <!-- TODO: Only show form on 3d articles pages? -->
    <!-- Begin MailChimp Signup Form -->
    <div id="mailchimp-3d-post-signup-form">
      <link href="./WebGL Skeletal Animation Tutorial_files/horizontal-slim-10_7.css" rel="stylesheet" type="text/css">
      <style type="text/css">
          #mc_embed_signup{background:#fff; clear:left; font:14px Helvetica,Arial,sans-serif; width:100%;}
          /* Add your own MailChimp form style overrides in your site stylesheet or in this style block.
             We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */
      </style>
      <div id="mc_embed_signup">
      <form action="http://gmail.us8.list-manage.com/subscribe/post?u=208823f024ad26be18074116e&amp;id=31091599dd" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate="">
          <div id="mc_embed_signup_scroll">
          <label for="mce-EMAIL">Get Weekly Graphics Programming Tips in your Inbox</label>
          <input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL" placeholder="email address" required="">
          <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
          <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_208823f024ad26be18074116e_31091599dd" tabindex="-1" value=""></div>
          <div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button cfn-subscribe-button"></div>
          <div style="margin: 0 auto; max-width: 450px; font-family: Helvetica; margin-top: 10px; line-height: 20px; color: #4f4f4f; font-size: 13px;">
            I'll send you short summaries of graphics programming concepts weekly
          <div>
          <div style="margin: 0 auto; max-width: 450px; font-family: Helvetica; margin-top: 5px; line-height: 20px; color: #4f4f4f; font-size: 13px;">
            You'll gain exposure to different graphics programming ideas
          <div>
          </div>
      
      </div>
      <!-- <em>Foo bar<em> -->
    </div>
    <!--End mc_embed_signup-->
</div></div></form></div></div></article>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <!--
      <h2 class="footer-heading">CFN</h2>
    -->
    <div class="footer-col-wrapper">

      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li><a href="mailto:frankie.nwafili@gmail.com">frankie.nwafili@gmail.com</a></li>
        </ul>
      </div>

      <div class="footer-col footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a id="twitter-follow-btn" href="https://twitter.com/chinedufn"><span class="icon icon--twitter"><svg class="twitter-svg-icon" viewBox="0 0 16 16"><path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"></path></svg>
</span><span class="username">Follow chinedufn</span></a>

          </li>
          

          <!--
          
          <li>
            <a href="https://github.com/chinedufn"><span class="icon icon--github"><svg viewBox="0 0 16 16"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span><span class="username">chinedufn</span></a>

          </li>
          
          -->
        </ul>
      </div>

      <div class="footer-col footer-col-3">
        <p>Hi. I'm Chinedu Francis Nwafili. I usually write about graphics programming but sometimes I'll switch it up. Let's chat!
</p>
      </div>
    </div>

  </div>

<script>
  // Disable Google analytics when developing locally
  if (document.location.hostname.search('chinedufn.com') !== -1) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-49025285-6', 'auto');
    ga('send', 'pageview');
  }
</script>

</footer>


  


</body></html>